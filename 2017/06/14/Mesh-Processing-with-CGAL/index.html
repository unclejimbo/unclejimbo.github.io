<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"unclejimbo.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"disqus","storage":true,"lazyload":false,"nav":null,"activeClass":"disqus"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="CGAL, which stands for the Computational Geometry Algorithms Library, is an important tool set to use and build geometric algorithms. It contains a tons of packages with various functionalities, so th">
<meta property="og:type" content="article">
<meta property="og:title" content="Mesh Processing with CGAL">
<meta property="og:url" content="https://unclejimbo.github.io/2017/06/14/Mesh-Processing-with-CGAL/index.html">
<meta property="og:site_name" content="unclejimbo&#39;s site">
<meta property="og:description" content="CGAL, which stands for the Computational Geometry Algorithms Library, is an important tool set to use and build geometric algorithms. It contains a tons of packages with various functionalities, so th">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://doc.cgal.org/latest/Surface_mesh_simplification/Illustration-Simplification-ALL.jpg">
<meta property="article:published_time" content="2017-06-14T06:24:34.000Z">
<meta property="article:modified_time" content="2022-04-21T06:25:17.272Z">
<meta property="article:author" content="unclejimbo">
<meta property="article:tag" content="Computer Graphics">
<meta property="article:tag" content="Geometry Processing">
<meta property="article:tag" content="CGAL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://doc.cgal.org/latest/Surface_mesh_simplification/Illustration-Simplification-ALL.jpg">

<link rel="canonical" href="https://unclejimbo.github.io/2017/06/14/Mesh-Processing-with-CGAL/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Mesh Processing with CGAL | unclejimbo's site</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-97325233-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-97325233-1');
      }
    </script>


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d49dcec5473b8cd98f08b6169b720538";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">unclejimbo's site</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-posts">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Posts</a>

  </li>
        <li class="menu-item menu-item-publications">

    <a href="/publications" rel="section"><i class="fa fa-book fa-fw"></i>Publications</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://unclejimbo.github.io/2017/06/14/Mesh-Processing-with-CGAL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/me.png">
      <meta itemprop="name" content="unclejimbo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="unclejimbo's site">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Mesh Processing with CGAL
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-06-14 14:24:34" itemprop="dateCreated datePublished" datetime="2017-06-14T14:24:34+08:00">2017-06-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-04-21 14:25:17" itemprop="dateModified" datetime="2022-04-21T14:25:17+08:00">2022-04-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computer-Graphics/" itemprop="url" rel="index"><span itemprop="name">Computer Graphics</span></a>
                </span>
            </span>

          
            <span id="/2017/06/14/Mesh-Processing-with-CGAL/" class="post-meta-item leancloud_visitors" data-flag-title="Mesh Processing with CGAL" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2017/06/14/Mesh-Processing-with-CGAL/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/06/14/Mesh-Processing-with-CGAL/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><a target="_blank" rel="noopener" href="http://www.cgal.org/index.html">CGAL</a>, which stands for the Computational Geometry Algorithms Library, is an important tool set to use and build geometric algorithms. It contains a tons of packages with various functionalities, so this time I’m only gonna explore a little part of this beast and figure out the basics to do mesh processing with CGAL.</p>
<p><img src="http://doc.cgal.org/latest/Surface_mesh_simplification/Illustration-Simplification-ALL.jpg"><br>(<em>Mesh smoothing algorithm, picture taken from the <a target="_blank" rel="noopener" href="http://doc.cgal.org/latest/Surface_mesh_simplification/index.html#Chapter_Triangulated_Surface_Mesh_Simplification">CGAL document</a></em>).</p>
<span id="more"></span>

<h1 id="Preliminaries"><a href="#Preliminaries" class="headerlink" title="Preliminaries"></a>Preliminaries</h1><p>First of all, I assume you already know the basics of mesh processing, especially the halfedge data structure, because all the related packages and algorithms in CGAL are implemented upon this data structure. If you don’t, <a target="_blank" rel="noopener" href="https://www.openmesh.org/Daily-Builds/Doc/a00016.html">here</a> is a concise introduction or you can resort to the <a target="_blank" rel="noopener" href="http://www.pmp-book.org/">PMP</a> book for a more comprehensive treatment.</p>
<p>And I also assume you have installed CGAL properly and run through the <a target="_blank" rel="noopener" href="http://doc.cgal.org/latest/Manual/tutorial_hello_world.html">hello world</a> tutorial if you haven’t used this library before.</p>
<p>Note that the stable release version of CGAL at the time of writing is 4.10.</p>
<h1 id="The-Polyhedron-3-Package"><a href="#The-Polyhedron-3-Package" class="headerlink" title="The Polyhedron_3 Package"></a>The Polyhedron_3 Package</h1><p>The <a target="_blank" rel="noopener" href="http://doc.cgal.org/latest/Polyhedron/index.html#Chapter_3D_Polyhedral_Surfaces">3D Polyhedral Surface</a> package, or Polyhedron_3 as its name in the program, is a pointer-based implementation of the halfedge data structure released since the 1.0 version of CGAL.</p>
<h2 id="Creation"><a href="#Creation" class="headerlink" title="Creation"></a>Creation</h2><p>There are convinient functions to create a tetrahedron though they are not very useful.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Traits &gt;</span><br><span class="line">Halfedge_handle CGAL::Polyhedron_3&lt; Traits &gt;::<span class="built_in">make_tetrahedron</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Traits &gt;</span><br><span class="line">Halfedge_handle CGAL::Polyhedron_3&lt; Traits &gt;::<span class="built_in">make_tetrahedron</span>(</span><br><span class="line">    <span class="type">const</span> Point&amp; p1,</span><br><span class="line">    <span class="type">const</span> Point&amp; p2,</span><br><span class="line">    <span class="type">const</span> Point&amp; p3,</span><br><span class="line">    <span class="type">const</span> Point&amp; p4</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>You can also read from a file, which is what we usually need in practice. Although it only support very few common file formats like off and obj. You can also write out Polyhedron_3 to a file.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CGAL/IO/Polyhedron_iostream.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">PolyhedronTraits_3</span>&gt;</span><br><span class="line">ostream&amp; <span class="keyword">operator</span>&lt;&lt;( ostream&amp; out,</span><br><span class="line"><span class="type">const</span> CGAL::Polyhedron_3&lt;PolyhedronTraits_3&gt;&amp; P);</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">PolyhedronTraits_3</span>&gt;</span><br><span class="line">istream&amp; <span class="keyword">operator</span>&gt;&gt;( istream&amp; in,</span><br><span class="line">CGAL::Polyhedron_3&lt;PolyhedronTraits_3&gt;&amp; P);</span><br></pre></td></tr></table></figure>

<p>When you need to read some other file formats not supported by this package, or to build the mesh procedurally, then you should use the incremental builder. The following example shows how to build up a Polyhedron_3 mesh from a list of veritices and indices.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CGAL/Simple_cartesian.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CGAL/Polyhedron_3.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CGAL/Polyhedron_incremental_builder_3.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Polyhedron_3&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TriMeshBuilder</span> : <span class="keyword">public</span> CGAL::Modifier_base&lt;<span class="keyword">typename</span> Polyhedron_3::HalfedgeDS&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> FT = <span class="keyword">typename</span> Polyhedron_3::Traits::Kernel::FT;</span><br><span class="line">    <span class="keyword">using</span> HDS = <span class="keyword">typename</span> Polyhedron_3::HalfedgeDS;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">TriMeshBuilder</span>(<span class="type">const</span> std::vector&lt;FT&gt;&amp; vertices, <span class="type">const</span> std::vector&lt;<span class="type">unsigned</span>&gt;&amp; indices)</span><br><span class="line">        : _vertices(vertices), _indices(indices)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">operator</span><span class="params">()</span><span class="params">(HDS&amp; hds)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="function">CGAL::Polyhedron_incremental_builder_3&lt;HDS&gt; <span class="title">builder</span><span class="params">(hds, <span class="literal">true</span>)</span></span>;</span><br><span class="line">        builder.<span class="built_in">begin_surface</span>(_vertices.<span class="built_in">size</span>(), _indices.<span class="built_in">size</span>() / <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; _vertices.<span class="built_in">size</span>(); i += <span class="number">3</span>) &#123;</span><br><span class="line">            builder.<span class="built_in">add_vertex</span>(HDS::Vertex::<span class="built_in">Point</span>(</span><br><span class="line">                _vertices[i], _vertices[i + <span class="number">1</span>], _vertices[i + <span class="number">2</span>]));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; _indices.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">            builder.<span class="built_in">begin_facet</span>();</span><br><span class="line">            builder.<span class="built_in">add_vertex_to_facet</span>(_indices[i++]);</span><br><span class="line">            builder.<span class="built_in">add_vertex_to_facet</span>(_indices[i++]);</span><br><span class="line">            builder.<span class="built_in">add_vertex_to_facet</span>(_indices[i]);</span><br><span class="line">            builder.<span class="built_in">end_facet</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        builder.<span class="built_in">end_surface</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    std::vector&lt;FT&gt; _vertices;</span><br><span class="line">    std::vector&lt;<span class="type">unsigned</span>&gt; _indices;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> Kernel = CGAL::Simple_cartesian&lt;<span class="type">float</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> FT = Kernel::FT;</span><br><span class="line"><span class="keyword">using</span> Polyhedron_3 = CGAL::Polyhedron_3&lt;Kernel&gt;;</span><br><span class="line"><span class="keyword">using</span> HDS = Polyhedron_3::HalfedgeDS;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::vector&lt;FT&gt; vertices;</span><br><span class="line">    std::vector&lt;<span class="type">unsigned</span>&gt; indices;</span><br><span class="line">    <span class="comment">// Fill in the data...</span></span><br><span class="line">    Polyhedron_3 P;</span><br><span class="line">    <span class="function">TriMeshBuilder&lt;HDS&gt; <span class="title">builder</span><span class="params">(vertices, indices)</span></span>;</span><br><span class="line">    P.<span class="built_in">delegate</span>(builder);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Navigation"><a href="#Navigation" class="headerlink" title="Navigation"></a>Navigation</h2><p>The key feature of a halfedge data structure is its flexibility to navigate on the mesh.</p>
<p>There are iterators you can use to iterate through vertices, halfedges, edges and facets. Keep in mind that when you dereference a iterator you’ll get the corresponding handle type. Their documentation is a bit of frustrating.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Vertex_iterator <span class="title">vertices_begin</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function">Vertix_iterator <span class="title">vertices_end</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function">Facet_iterator <span class="title">facets_begin</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function">Facet_iterator <span class="title">facets_end</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// etc</span></span><br></pre></td></tr></table></figure>

<p>There is also a special type of iterator called the circulator, who can iterate around a target primitive. Note that the below functions are accessed from a handle, and return a halfedge handle from which the desired primitive can be resolved.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Iterate around all the vertices of a facet,</span></span><br><span class="line"><span class="function">Halfedge_around_facet_circulator <span class="title">facet_begin</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// Iterate around all the vertices incident of a vertex</span></span><br><span class="line"><span class="function">Halfedge_around_vertex_circulator <span class="title">vertex_begin</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>Let’s see a concrete example to compute the valence of a mesh, I’m only showing the key part.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Polyhedron_3 P;</span><br><span class="line">    <span class="keyword">for</span> (Vertex_iterator vit = P.<span class="built_in">vertices_begin</span>(); vit != P.<span class="built_in">vertices_end</span>(); ++vit) &#123;</span><br><span class="line">        <span class="keyword">auto</span> valence = <span class="number">0</span>;</span><br><span class="line">        Halfedge_around_vertex_circulator vcir = vit-&gt;<span class="built_in">vertex_begin</span>();</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            ++valence;</span><br><span class="line">        &#125; <span class="keyword">while</span>(++vcir != vit-&gt;<span class="built_in">vertex_begin</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="The-Surface-mesh-Package"><a href="#The-Surface-mesh-Package" class="headerlink" title="The Surface_mesh Package"></a>The Surface_mesh Package</h1><p>Since version 4.6, CGAL introduces a new <a target="_blank" rel="noopener" href="http://doc.cgal.org/latest/Surface_mesh/index.html#sectionSurfaceMeshUsage">Surface Mesh</a> package to replace the old Polyhedron_3 package. So why do we need another halfedge data structure? This <a target="_blank" rel="noopener" href="http://imr.sandia.gov/papers/imr20/Sieger.pdf">benchmark</a> shows that the Surface_mesh package achieves better runtime speed with less memory footprints. The reason behind this achievement is because this new package uses an index-based approach to store the mesh, rather than the pointer-based approach taken by Polyhedron_3. So it is recommended to use this package as your first choice. Although at the time of writing there are a few packages in CGAL who still don’t support Surface_mesh, so you may want to resort to Polyhedron_3 in such a situation.</p>
<p>The official examples and documentations for this package are much more well-organized. With the experience you already gained from Polyhedron_3, I’m sure you could head directly to the manual and learn how to use this package by yourself.</p>
<h1 id="Let’s-Be-More-Generic"><a href="#Let’s-Be-More-Generic" class="headerlink" title="Let’s Be More Generic"></a>Let’s Be More Generic</h1><p>From this point on, you already have enough ground to use the mesh data structures. So you could head towards to the specific mesh processing algorithm you need to use. There are quite a few packages out there, including Polygon_mesh_processing, Subdivision, Segmentation, just to name a few. But if you need to use the halfedge data structures provided by CGAL and implement your own mesh processing algorithms on top of that, then you might want to learn more on how to do this effectively.</p>
<p>If you go to check those algorithmic packages and you’ll find out that most of them support both Polyhedron_3 and Surface_mesh using the same interface. How to achieve that? Do we have to manually convert one data structure to another? Or do we have to specialize every algorithm for these two data structures? The way CGAL deals with different halfedge implementations is through concepts and traits.</p>
<p>Manifold surface meshes are in essence graphs, so CGAL defines several <a target="_blank" rel="noopener" href="http://doc.cgal.org/latest/BGL/group__PkgBGLConcepts.html">graph concepts</a> to abstract away the behaviour a halfedge data structure should abide. By parameterizing the mesh data type using template and programming against the graph concepts, any implementation that meets the definition of those concepts can be used by the algorithm.</p>
<p>In order to transform the interfaces of both data structures to conform to the interface required by the graph concepts, CGAL defines a lot of trait classes, which all reside in the “CGAL&#x2F;boost&#x2F;graph” directory. Except for Polyhedron_3 and Surface_mesh, a lot of other data structures in CGAL could also use traits to conform to the graph concepts so as to be used by the algorithms. There is even a trait class for <a target="_blank" rel="noopener" href="https://www.openmesh.org/">OpenMesh</a>, which is also a popular choice of halfedge implementation, defined in the file “graph_traits_TriMesh_ArrayKernelT.h”. In other words, all the algorithms written against the graph concepts could also operate on OpenMesh.</p>
<p>That’s how generic programming saves the world. In fact, the graph concepts defined by CGAL actually conform to the API defined by <a target="_blank" rel="noopener" href="http://www.boost.org/doc/libs/1_64_0/libs/graph/doc/">BGL</a>, a general graph library, so some basic graph algorithms like shortest path or minimum spanning tree could also operate on Polyhedron_3 and Surface_mesh. As a result, as long as you write your own algorithm using the interface defined by the graph concepts, a lot of data structures could be used with only one implementation. Awesome.</p>
<h2 id="Let’s-Be-More-Concrete"><a href="#Let’s-Be-More-Concrete" class="headerlink" title="Let’s Be More Concrete"></a>Let’s Be More Concrete</h2><p>Now I’ll show you one concrete example on how this thing works. Why don’t we just checkout the mesh fairing function from the <a target="_blank" rel="noopener" href="http://doc.cgal.org/latest/Polygon_mesh_processing/group__PMP__meshing__grp.html#gaa091c8368920920eed87784107d68ecf">Polygon Mesh Processing</a> package.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> TriangleMesh, <span class="keyword">typename</span> VertexRange, <span class="keyword">typename</span> NamedParameters&gt;</span><br><span class="line"><span class="type">bool</span> CGAL::Polygon_mesh_processing::<span class="built_in">fair</span>(</span><br><span class="line">    TriangleMesh&amp; tmesh,</span><br><span class="line">    <span class="type">const</span> VertexRange&amp; vertices,</span><br><span class="line">    <span class="type">const</span> NamedParameters&amp; np</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>This function takes in a mesh and range of vertices you want to fair, and smoothes out the mesh as much as possible. The np parameter is not important here. So how does CGAL make this function work on all the data structure? We should look into the source code in file “CGAL\Polygon_mesh_processing\internal\fair_impl.h” to see what happens.</p>
<p>We could see that the algorithm is implemented with the graph concept api rather than any class-specific interface.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">typename</span> boost::graph_traits&lt;PolygonMesh&gt;::vertex_descriptor vertex_descriptor;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">vertex_descriptor nv = <span class="built_in">target</span>(<span class="built_in">opposite</span>(*circ,pmesh),pmesh);</span><br><span class="line"><span class="comment">//...</span></span><br></pre></td></tr></table></figure>

<p>And the real implementations for these apis are actually template specializations for each known data structure defined in the trait classes I mentioned earlier. You could check the implementation of Polyhedron_3 for example in “CGAL&#x2F;boost&#x2F;graph&#x2F;graph_traits_Polyhedron_3.h”.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">Gt</span>, <span class="keyword">class</span> <span class="title class_">I</span>, CGAL_HDS_PARAM_, <span class="keyword">class</span> <span class="title class_">A</span>&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">graph_traits</span>&lt; CGAL::Polyhedron_3&lt;Gt,I,HDS,A&gt; &gt;</span><br><span class="line">   : CGAL::HDS_graph_traits&lt; CGAL::Polyhedron_3&lt;Gt,I,HDS,A&gt; &gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">typedef</span> <span class="keyword">typename</span> Gt::Point_3 vertex_property_type;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">Gt</span>, <span class="keyword">class</span> <span class="title class_">I</span>, CGAL_HDS_PARAM_, <span class="keyword">class</span> <span class="title class_">A</span>&gt;</span><br><span class="line"><span class="keyword">typename</span> boost::graph_traits&lt; CGAL::Polyhedron_3&lt;Gt,I,HDS,A&gt; <span class="type">const</span>&gt;::<span class="function">vertex_descriptor</span></span><br><span class="line"><span class="function"><span class="title">target</span><span class="params">(<span class="keyword">typename</span> boost::graph_traits&lt; CGAL::Polyhedron_3&lt;Gt,I,HDS,A&gt; <span class="type">const</span>&gt;::edge_descriptor e</span></span></span><br><span class="line"><span class="params"><span class="function">       , <span class="type">const</span> CGAL::Polyhedron_3&lt;Gt,I,HDS,A&gt; &amp; )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> e.<span class="built_in">halfedge</span>()-&gt;<span class="built_in">vertex</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">Gt</span>, <span class="keyword">class</span> <span class="title class_">I</span>, CGAL_HDS_PARAM_, <span class="keyword">class</span> <span class="title class_">A</span>&gt;</span><br><span class="line"><span class="keyword">typename</span> boost::graph_traits&lt; CGAL::Polyhedron_3&lt;Gt,I,HDS,A&gt; &gt;::<span class="function">halfedge_descriptor</span></span><br><span class="line"><span class="function"><span class="title">opposite</span><span class="params">(<span class="keyword">typename</span> boost::graph_traits&lt; CGAL::Polyhedron_3&lt;Gt,I,HDS,A&gt; &gt;::halfedge_descriptor h</span></span></span><br><span class="line"><span class="params"><span class="function">         , <span class="type">const</span> CGAL::Polyhedron_3&lt;Gt,I,HDS,A&gt;&amp;)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> h-&gt;<span class="built_in">opposite</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//...</span></span><br></pre></td></tr></table></figure>

<p>In this way, the compiler will automatically use the right specialization for a data structure to use. This is often called static dispatch.</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>I hope that I have sorted out some of the mess about using this library. You may also be interested in reading the <a target="_blank" rel="noopener" href="http://doc.cgal.org/latest/BGL/index.html#Chapter_CGAL_and_the_Boost_Graph_Library">BGL package</a> and <a target="_blank" rel="noopener" href="http://doc.cgal.org/latest/Property_map/index.html#Chapter_CGAL_and_Boost_Property_Maps">Boost PropertyMap package</a> for further information.</p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>unclejimbo
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="https://unclejimbo.github.io/2017/06/14/Mesh-Processing-with-CGAL/" title="Mesh Processing with CGAL">https://unclejimbo.github.io/2017/06/14/Mesh-Processing-with-CGAL/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Computer-Graphics/" rel="tag"># Computer Graphics</a>
              <a href="/tags/Geometry-Processing/" rel="tag"># Geometry Processing</a>
              <a href="/tags/CGAL/" rel="tag"># CGAL</a>
          </div>

        


        
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Preliminaries"><span class="nav-number">1.</span> <span class="nav-text">Preliminaries</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#The-Polyhedron-3-Package"><span class="nav-number">2.</span> <span class="nav-text">The Polyhedron_3 Package</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Creation"><span class="nav-number">2.1.</span> <span class="nav-text">Creation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Navigation"><span class="nav-number">2.2.</span> <span class="nav-text">Navigation</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#The-Surface-mesh-Package"><span class="nav-number">3.</span> <span class="nav-text">The Surface_mesh Package</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Let%E2%80%99s-Be-More-Generic"><span class="nav-number">4.</span> <span class="nav-text">Let’s Be More Generic</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Let%E2%80%99s-Be-More-Concrete"><span class="nav-number">4.1.</span> <span class="nav-text">Let’s Be More Concrete</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Conclusion"><span class="nav-number">5.</span> <span class="nav-text">Conclusion</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="unclejimbo"
      src="/images/me.png">
  <p class="site-author-name" itemprop="name">unclejimbo</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">8</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/unclejimbo" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;unclejimbo" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:wangsd@ios.ac.cn" title="E-Mail → mailto:wangsd@ios.ac.cn" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">unclejimbo</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        






<script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              leancloudSelector(url).innerText = 'Counter not initialized! More info at console err msg.';
              console.error('ATTENTION! LeanCloud counter has security bug, see how to solve it here: https://github.com/theme-next/hexo-leancloud-counter-security. \n However, you can still use LeanCloud without security, by setting `security` option to `false`.');
            
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":true,"app_id":"JVGcFwDqMgSaNGKdFXnKQLH5-gzGzoHsz","app_key":"Vc3vhEn4KvHJX7OTHMpugy14","server_url":null,"security":true};
    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>


      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://unclejimbos.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://unclejimbo.github.io/2017/06/14/Mesh-Processing-with-CGAL/";
    this.page.identifier = "2017/06/14/Mesh-Processing-with-CGAL/";
    this.page.title = "Mesh Processing with CGAL";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://unclejimbos.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
